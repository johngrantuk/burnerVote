(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(64)},56:function(e,t,a){},58:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(30),s=a.n(o),l=a(2),c=a.n(l),i=a(4),u=a(6),p=a(7),d=a(9),m=a(8),h=a(10),f=a(31),v=a.n(f),b=a(66),y=a(67),g=a(42),E=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={deposits:[],uniqueAddresses:[],graphLoaded:!1},a.componentDidMount=Object(i.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.processVotes();case 2:case"end":return e.stop()}},e,this)})),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"GetProposalGraphData",value:function(){var e=Object(i.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("GetProposalGraphData(): "+t),a='{ anonymousDeposits (where: {PropName: "'+t+'"}) {\n        id\n        SenderAddr\n        ContriValue\n        PropName\n        Choice\n      }\n    }',e.next=4,fetch("https://api.thegraph.com/subgraphs/name/madhur4444/imgovdynamic",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:a})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"CalculateVotesBasic",value:function(){var e=Object(i.a)(c.a.mark(function e(t){var a,n,r,o,s,l,i,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.data.anonymousDeposits,n=0,r=0,o=a.length,s=[],l={},i=0,u=0;u<o;u++)-1===s.indexOf(a[u].SenderAddr)?(s.push(a[u].SenderAddr),l[a[u].SenderAddr]=parseFloat(a[u].ContriValue)):l[a[u].SenderAddr]+=parseFloat(a[u].ContriValue),"yes"===a[u].Choice?n++:r++,i+=parseFloat(a[u].ContriValue);console.log(this.props.proposal.name),console.log("Total: "+o),console.log("Yes: "+n),console.log("No: "+r),console.log("No Unique Addresses: "+s.length),console.log(s),console.log("Total Value: "+i),console.log(l),this.setState({graphLoaded:!0,deposits:a,yesCount:n,noCount:r,uniqueAddresses:s});case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"GetAddressVotes",value:function(){var e=Object(i.a)(c.a.mark(function e(t){var a,n,r,o,s,l,i,u,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.data.anonymousDeposits,n=a.length,r={},o=0,s=0;s<n;s++)l=0,i=0,"yes"===a[s].Choice?l=parseFloat(a[s].ContriValue):i=parseFloat(a[s].ContriValue),void 0===r[a[s].SenderAddr]?r[a[s].SenderAddr]={yesTotalValue:l,noTotalValue:i}:(u=r[a[s].SenderAddr].yesTotalValue+l,p=r[a[s].SenderAddr].noTotalValue+i,r[a[s].SenderAddr]={yesTotalValue:u,noTotalValue:p}),o+=parseFloat(a[s].ContriValue);return console.log(this.props.proposal.name),console.log("No Deposits: "+n),console.log("Total Value: "+o),console.log("Voters:"),console.log(r),this.setState({totalValue:o,voters:r}),e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"GetQuadraticTotals",value:function(){var e=Object(i.a)(c.a.mark(function e(t){var a,n,r,o,s,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=0,n=0,r=0,o=0,e.t0=c.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=16;break}if(s=e.t1.value,t.hasOwnProperty(s)){e.next=9;break}return e.abrupt("continue",5);case 9:l=t[s],a+=Math.sqrt(l.yesTotalValue),n+=Math.sqrt(l.noTotalValue),r+=1,o=o+l.yesTotalValue+l.noTotalValue,e.next=5;break;case 16:this.setState({graphLoaded:!0,yesCount:a,noCount:n,noUniqueAdresses:r,totalValue:o});case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"processVotes",value:function(){var e=Object(i.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GetProposalGraphData(this.props.proposal.name);case 2:if((t=e.sent).data){e.next=6;break}return console.log("MMMhhhh this is weird..."),e.abrupt("return");case 6:return e.next=8,this.GetAddressVotes(t);case 8:return a=e.sent,e.next=11,this.GetQuadraticTotals(a);case 11:console.log("graph() OUT");case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e;this.state.graphLoaded&&(e=r.a.createElement(v.a,{animate:!1,animationDuration:500,animationEasing:"ease-out",cx:50,cy:50,data:[{color:"#E38627",title:"Yes",value:this.state.yesCount},{color:"#C13C37",title:"Two",value:this.state.noCount}],label:!0,labelPosition:50,labelStyle:{fill:"#121212",fontFamily:"sans-serif",fontSize:"5px"},lengthAngle:360,lineWidth:100,onClick:void 0,onMouseOut:void 0,onMouseOver:void 0,paddingAngle:0,radius:50,ratio:1,rounded:!1,startAngle:0,style:{height:"300px"}}));var t=this.state.noUniqueAdresses,a={textAlign:"center"};return r.a.createElement("div",null,r.a.createElement(b.a,null,r.a.createElement(y.a,{className:"col-sm"},r.a.createElement("h3",{style:a},"Yes"),r.a.createElement("p",null,"Yes Votes: ",this.state.yesCount),r.a.createElement("p",null,"To vote YES to this proposal send any amount of ETH to:"),r.a.createElement("div",null,r.a.createElement("div",{style:{textAlign:"center",backgroundColor:"white"}},r.a.createElement(g,{value:this.props.proposal.optionAaddr,style:{paddingTop:"10px"}}))),r.a.createElement("p",null,this.props.proposal.optionAaddr)),r.a.createElement(y.a,{className:"col-sm"},r.a.createElement("h2",{style:a},this.props.proposal.name),r.a.createElement("p",null,"Total Value Burned (wei): ",this.state.totalValue),r.a.createElement("p",null,"Unique Voters: ",t),e),r.a.createElement(y.a,{className:"col-sm"},r.a.createElement("h3",{style:a},"No"),r.a.createElement("p",null,"No Votes: ",this.state.noCount),r.a.createElement("p",null,"To vote NO to this proposal send any amount of ETH to:"),r.a.createElement("div",null,r.a.createElement("div",{style:{textAlign:"center",backgroundColor:"white"}},r.a.createElement(g,{value:this.props.proposal.optionBaddr,style:{paddingTop:"10px"}}))),r.a.createElement("p",null,this.props.proposal.optionBaddr))),r.a.createElement("hr",null))}}]),t}(n.Component),w=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.proposals.map(function(e){return r.a.createElement(E,{key:e.id,proposal:e})});return r.a.createElement("div",null,r.a.createElement("h2",null,"Proposals"),e)}}]),t}(n.Component),N=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top "},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"navbar-wrapper"},r.a.createElement("a",{className:"navbar-brand",href:"/"},"Burn Signal")),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","aria-controls":"navigation-index","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"sr-only"},"Toggle navigation"),r.a.createElement("span",{className:"navbar-toggler-icon icon-bar"}),r.a.createElement("span",{className:"navbar-toggler-icon icon-bar"}),r.a.createElement("span",{className:"navbar-toggler-icon icon-bar"})),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-end"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"/"},r.a.createElement("i",{className:"tim-icons icon-bell-55"}),"  Notifications"))))))}}]),t}(n.Component),O=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"sidebar-wrapper"},r.a.createElement("ul",{className:"nav"},r.a.createElement("li",{className:"active "},r.a.createElement("a",{href:"/"},r.a.createElement("i",{className:"tim-icons icon-chart-pie-36"}),r.a.createElement("p",null,"Dashboard"))),r.a.createElement("li",null,r.a.createElement("a",{href:"/#/newVote"},r.a.createElement("i",{className:"tim-icons icon-bulb-63"}),r.a.createElement("p",null,"New Proposal"))))))}}]),t}(n.Component);a(56),a(58);function j(){return x.apply(this,arguments)}function x(){return(x=Object(i.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("TheGraph - getProposals()"),'{\n    newProposalIssueds(where: { name_not_contains: "fae" }) {\n      id\n      issuer\n      deadline\n      name\n      data\n      optionBaddr\n      optionAaddr\n    }\n  }',e.next=4,fetch("https://api.thegraph.com/subgraphs/name/madhur4444/imgovdynamic",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:'{\n    newProposalIssueds(where: { name_not_contains: "fae" }) {\n      id\n      issuer\n      deadline\n      name\n      data\n      optionBaddr\n      optionAaddr\n    }\n  }'})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 4:return t=e.sent,console.log("TheGraph - got Proposals."),e.abrupt("return",t.data.newProposalIssueds);case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var k=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={proposals:[],deposits:[]},a.componentDidMount=Object(i.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j();case 3:t=e.sent,a.setState({proposals:t}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Error loading The Graph"),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,7]])})),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(O,null),r.a.createElement("div",{className:"main-panel"},r.a.createElement(N,null),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement(w,{proposals:this.state.proposals})))))}}]),t}(n.Component),V=a(19),A=a(15),C=a.n(A);function T(e,t){return S.apply(this,arguments)}function S(){return(S=Object(i.a)(c.a.mark(function e(t,a){var n,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=13;break}return n=new C.a(window.ethereum),e.prev=2,e.next=5,window.ethereum.enable();case 5:t(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),a(e.t0);case 11:e.next=14;break;case 13:window.web3?(r=window.web3,console.log("Injected web3 detected."),t(r)):(o=new C.a.providers.HttpProvider("http://127.0.0.1:8545"),s=new C.a(o),console.log("No web3 instance injected, using Local web3."),t(s));case 14:case"end":return e.stop()}},e,this,[[2,8]])}))).apply(this,arguments)}var P=function(){return new Promise(function(e,t){"complete"===document.readyState&&(T(e,t),console.log("Web3 Loaded Ok")),window.addEventListener("load",Object(i.a)(c.a.mark(function a(){return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:T(e,t),console.log("Web3 Loaded.");case 2:case"end":return a.stop()}},a,this)})))})},D=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={web3:null,accounts:null,contract:null},a.componentDidMount=Object(i.a)(c.a.mark(function e(){var t,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Loading web3..."),e.next=4,P();case 4:return t=e.sent,e.next=7,t.eth.getAccounts();case 7:n=e.sent,"0x6936b81d7629378aabddcf882b2a7fdfff1cd962",r=new t.eth.Contract(q,"0x6936b81d7629378aabddcf882b2a7fdfff1cd962"),a.setState({web3:t,accounts:n,contract:r}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),alert("Error loading The Graph"),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,13]])})),a.makeNewVote=a.makeNewVote.bind(Object(V.a)(Object(V.a)(a))),a.updateQuestion=a.updateQuestion.bind(Object(V.a)(Object(V.a)(a))),a.updateDeadline=a.updateDeadline.bind(Object(V.a)(Object(V.a)(a))),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"makeNewVote",value:function(){var e=Object(i.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("New Vote"),console.log(this.state.question),console.log(this.state.deadline),console.log("Sending transaction..."),e.next=6,this.state.contract.methods.newVoteProposal(this.state.question,"Here is some data",Date.now()+36e5).send({from:this.state.accounts[0]});case 6:console.log("Done?");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateQuestion",value:function(e){this.setState({question:e.target.value})}},{key:"updateDeadline",value:function(e){this.setState({deadline:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(O,null),r.a.createElement("div",{className:"main-panel"},r.a.createElement(N,null),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"title"},"Ask a question...")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 pr-md-1"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Your Question"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Ask Away",onChange:this.updateQuestion})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 pr-md-1"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Deadline"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Block No",onChange:this.updateDeadline})))))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("button",{type:"submit",className:"btn btn-fill btn-primary",onClick:this.makeNewVote},"Post"))))))))}}]),t}(n.Component),q=[{constant:!1,inputs:[{name:"_name",type:"string"},{name:"_data",type:"string"},{name:"_deadline",type:"uint64"}],name:"newVoteProposal",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"proposalID",type:"uint256"},{indexed:!1,name:"issuer",type:"address"},{indexed:!1,name:"deadline",type:"uint256"},{indexed:!1,name:"name",type:"string"},{indexed:!1,name:"data",type:"string"}],name:"newProposalIssued",type:"event"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proposals",outputs:[{name:"issuer",type:"address"},{name:"deadline",type:"uint256"},{name:"name",type:"string"},{name:"data",type:"string"}],payable:!1,stateMutability:"view",type:"function"}];Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var G=a(32),M=a(17);s.a.render(r.a.createElement(G.a,{basename:"/"},r.a.createElement("div",null,r.a.createElement("main",null,r.a.createElement(M.a,{exact:!0,path:"/",component:k}),r.a.createElement(M.a,{path:"/home",component:k}),r.a.createElement(M.a,{path:"/about",component:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"About"))}}),r.a.createElement(M.a,{path:"/newVote",component:D}),r.a.createElement(M.a,{exact:!0,path:"/profile/:address",component:function(e){var t=e.match;return r.a.createElement("div",null,r.a.createElement("h2",null,"Profile For Address: ",t.params.address))}})))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,2,1]]]);
//# sourceMappingURL=main.a7b92a9a.chunk.js.map